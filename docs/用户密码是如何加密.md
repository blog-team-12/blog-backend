# BcryptHash 和 BcryptCheck 函数说明（密码安全处理）
我们用一种更简单的方式来解释这两个用于处理密码安全的函数。


## BcryptHash（密码加密存储）
想象一下，你有一个密码，比如“123456”。你不能直接把这个密码明文存到数据库里，因为如果数据库泄露，所有人的密码就都泄露了。

所以，我们需要把这个密码转换成一个不可识别的字符串（称为哈希值），然后存储这个哈希值。

但是，简单的哈希（比如MD5）现在也不安全了，因为黑客可以预先计算很多常见密码的哈希值（彩虹表），然后反向查询出密码。

所以，我们使用bcrypt算法，它有两个特点：
- 它会自动生成一个随机的盐（salt）。盐就像是一把钥匙，每个密码的盐都不同，所以即使两个用户的密码相同，生成的哈希值也不同。
- 它很慢（可以调节成本因子，让计算变慢）。这样黑客尝试暴力破解的时候就需要花非常多的时间。

### 过程
1. 你输入密码（比如“123456”）
2. BcryptHash函数会调用bcrypt.GenerateFromPassword，生成一个哈希字符串。
3. 这个字符串包含了：算法标识、成本因子、盐和哈希值。看起来像这样：
   "$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy"

   **其中：**
   $2a$ 表示使用的是bcrypt算法。
   $10$ 表示成本因子是10（2的10次方轮哈希）。
   后面的一部分是盐和哈希值的组合。


---


## BcryptCheck（密码验证）
当用户登录时，他输入密码，比如“123456”。我们需要验证这个密码是否正确。

我们不会把存储的哈希值解密（因为哈希是单向的，不能解密），而是用同样的方法对用户输入的密码进行哈希，然后比较两个哈希值是否相同。

但是，bcrypt的哈希值中已经包含了盐和成本因子，所以我们在验证的时候，只需要用这个存储的哈希值作为模板，对用户输入的密码用相同的盐和成本因子进行哈希，然后比较结果。

### 过程
1. 从数据库取出之前存储的哈希值（比如上面那个字符串）。
2. 调用BcryptCheck，传入用户输入的密码和数据库中的哈希值。
3. bcrypt.CompareHashAndPassword函数会从哈希值中提取出盐和成本因子，然后对用户输入的密码进行相同的哈希计算。
4. 如果计算出来的哈希值和存储的哈希值相同，就返回true，否则返回false。

这样，即使黑客拿到了数据库的哈希值，也无法快速推算出原始密码。


要不要我帮你将这份说明整理成一份**带目录导航的Markdown文档**，方便你直接在文档工具中查看和使用？

# 3. MD5V - 快速哈希计算

## 用途
生成数据的唯一标识或校验和

---

## 工作原理
```go
h := md5.New()
h.Write(str)
return hex.EncodeToString(h.Sum(b))
```
- 使用 MD5 算法计算哈希值
- 支持可选的追加字节
- 返回十六进制字符串

---

## 使用场景
```go
// 生成文件校验和
fileHash := MD5V(fileContent)

// 生成缓存键
cacheKey := MD5V([]byte(userID + timestamp))

// 数据去重
dataHash := MD5V([]byte(data))
```

---

## 输出示例
```text
"e10adc3949ba59abbe56e057f20f883e"
```

md5，更适合
1、文件完整性校验
2、缓存键生成
3、数据去重

**版本**: v0.5
**最后更新**: 2025-10-28
**维护者**: 王得贤